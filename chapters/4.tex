% Chapter 4

\chapter{Architecture}

\label{ch:architecture}

%----------------------------------------------------------------------------------------

\section{Overview}\label{sec:overview}

Tangible is implemented as a single Python package, without any external
dependencies.

The architecture of Tangible can be categorized into four different parts: The
\hyperref[sec:ast]{abstract syntax tree (AST)}, \hyperref[sec:backends]{code
generation backends}, \hyperref[sec:shapes]{shapes} and
\hyperref[sec:utils]{utils}.

\vspace{7mm}

\begin{figure}[h]
	\centering
	\input{tikz/architecture}
	\caption{Architecture Diagram}
	\label{img:architecture}
\end{figure}

%----------------------------------------------------------------------------------------

\section{AST}\label{sec:ast}

The \texttt{ast.py} module provides the objects for the abstract syntax tree
(AST) for Tangible. All AST objects extend a single base class called
\texttt{AST}. This base class is responsible for three things:

\begin{itemize}
	\item It provides a single base type to use for type checking, e.g.
		\texttt{isinstance(mysubclass, ast.AST)}.
	\item It overrides the \texttt{\_\_eq\_\_} and \texttt{\_\_ne\_\_} methods in
		a way that all subclasses are compared by value (using
		\texttt{self.\_\_dict\_\_}), and not by identity.
	\item It provides a \texttt{\_\_repr\_\_} implementation that displays both
		the class name as well as the object memory address, which simplifies
		debugging.
\end{itemize}

\noindent The module contains the following classes:

\subsection*{Base Class}
\stepcounter{subsection}\addcontentsline{toc}{subsection}{\thesubsection\hspace*{1.19em}Base Class}

\begin{itemize}
	\item \texttt{AST}: The base shape for all AST elements, as described above.
\end{itemize}

\subsection*{2D Shapes}
\stepcounter{subsection}\addcontentsline{toc}{subsection}{\thesubsection\hspace*{1.19em}2D Shapes}

\begin{itemize}
	\item \texttt{Circle}: A circle shape with a specified radius.
	\item \texttt{CircleSector}: A circle sector shape (pizza slice) with a
		specified radius and angle.
	\item \texttt{Rectangle}: A rectangular shape with a specified width and
		height.
	\item \texttt{Polygon}: A polygon shape made from a list of 2D coordinates.
\end{itemize}

\subsection*{3D Shapes}
\stepcounter{subsection}\addcontentsline{toc}{subsection}{\thesubsection\hspace*{1.19em}3D Shapes}

\begin{itemize}
	\item \texttt{Cube}: A cube with a specified width, height and depth.
	\item \texttt{Sphere}: A sphere with a specified radius.
	\item \texttt{Cylinder}: A cylinder with a height and top/bottom radii.
	\item \texttt{Polyhedron}: An arbitrary 3D shape made from connected triangles
		or quads.
\end{itemize}

\subsection*{Transformations}
\stepcounter{subsection}\addcontentsline{toc}{subsection}{\thesubsection\hspace*{1.19em}Transformations}

\begin{itemize}
	\item \texttt{Translate}: Used to translate an object.
	\item \texttt{Rotate}: Used to rotate an object.
	\item \texttt{Scale}: Used to scale an object.
	\item \texttt{Mirror}: Used to mirror an object.
\end{itemize}

\subsection*{Boolean Operations}
\stepcounter{subsection}\addcontentsline{toc}{subsection}{\thesubsection\hspace*{1.19em}Boolean Operations}

\begin{itemize}
	\item \texttt{Union}: Combine multiple shapes into a single shape.
	\item \texttt{Difference}: A boolean difference of two or more shapes.
	\item \texttt{Intersection}: A boolean intersection of two or more shapes.
\end{itemize}

\subsection*{Extrusions}
\stepcounter{subsection}\addcontentsline{toc}{subsection}{\thesubsection\hspace*{1.19em}Extrusions}

\begin{itemize}
	\item \texttt{LinearExtrusion}: Extrude a 2D object linearly along the z axis.
	\item \texttt{RotateExtrusion}: Extrude a 2D object around the z axis. 
\end{itemize}

%----------------------------------------------------------------------------------------

\section{Backends}\label{sec:backends}

The backends are responsible for code generation. They receive an
\hyperref[sec:ast]{AST} instance and generate backend specific code from it.

At the time of this writing, only one backend has been implemented: The OpenSCAD
backend. But it would be very easy to add additional backends in the future.

%----------------------------------------------------------------------------------------

\section{Shapes}\label{sec:shapes}

%----------------------------------------------------------------------------------------

\section{Utils}\label{sec:utils}
